{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.15", "generated_at": "2025-12-15T19:10:04.638903Z", "invocation_id": "560a4c80-1052-4fa1-ac1b-83d20f08cd55", "invocation_started_at": "2025-12-15T19:10:01.932864Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-15T19:10:03.795378Z", "completed_at": "2025-12-15T19:10:03.800868Z"}, {"name": "execute", "started_at": "2025-12-15T19:10:03.801113Z", "completed_at": "2025-12-15T19:10:03.927362Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.13343119621276855, "adapter_response": {"_message": "SELECT 4577", "code": "SELECT", "rows_affected": 4577}, "message": "SELECT 4577", "failures": null, "unique_id": "model.dbt_enpal.activity", "compiled": true, "compiled_code": "\n\nWITH deduplicated AS (\n    SELECT DISTINCT *\n    FROM \"postgres\".\"public\".\"activity\"\n)\n\nSELECT\n    CONCAT(activity_id, '_', due_to) AS unique_activity_id,\n    *\nFROM deduplicated\n-- For this deal, we have an exception where sales_call_2 is \n-- scheduled before sales_call_1. I assume that should not happen\n-- in normal cases, so I will exclude this deal from the final output\nWHERE\n    deal_id != 960413", "relation_name": "\"postgres\".\"public_cl_enpal\".\"activity\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-15T19:10:03.932467Z", "completed_at": "2025-12-15T19:10:03.934714Z"}, {"name": "execute", "started_at": "2025-12-15T19:10:03.934946Z", "completed_at": "2025-12-15T19:10:04.049956Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1183478832244873, "adapter_response": {"_message": "SELECT 15406", "code": "SELECT", "rows_affected": 15406}, "message": "SELECT 15406", "failures": null, "unique_id": "model.dbt_enpal.deals", "compiled": true, "compiled_code": "WITH deduplicated AS (\n    SELECT DISTINCT *\n    FROM \"postgres\".\"public\".\"deal_changes\"\n),\n\nrow_numbers AS (\n    SELECT\n        *,\n        ROW_NUMBER() OVER (\n            PARTITION BY deal_id, changed_field_key, new_value\n            ORDER BY change_time DESC\n        ) AS rn\n    FROM deduplicated\n)\n\nSELECT\n    CONCAT(deal_id, '_', changed_field_key, '_', new_value, '_', rn) AS unique_activity_id,\n    *\nFROM row_numbers", "relation_name": "\"postgres\".\"public_cl_enpal\".\"deals\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-15T19:10:04.052591Z", "completed_at": "2025-12-15T19:10:04.055352Z"}, {"name": "execute", "started_at": "2025-12-15T19:10:04.055597Z", "completed_at": "2025-12-15T19:10:04.100975Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04917597770690918, "adapter_response": {"_message": "SELECT 5", "code": "SELECT", "rows_affected": 5}, "message": "SELECT 5", "failures": null, "unique_id": "model.dbt_enpal.lost_reasons", "compiled": true, "compiled_code": "\n\n\nWITH filtered_data AS (\n    SELECT field_value_options\n    FROM \"postgres\".\"public\".\"fields\"\n    WHERE field_key = 'lost_reason'\n)\n\nSELECT\n    x.id AS lost_reason_id,\n    x.label AS lost_reason\nFROM filtered_data,\n    jsonb_array_elements(field_value_options) AS t(doc),\n    jsonb_to_record(t.doc) AS x (\"id\" INT, \"label\" TEXT)", "relation_name": "\"postgres\".\"public_cl_enpal\".\"lost_reasons\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-15T19:10:04.103976Z", "completed_at": "2025-12-15T19:10:04.111848Z"}, {"name": "execute", "started_at": "2025-12-15T19:10:04.112628Z", "completed_at": "2025-12-15T19:10:04.155388Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0533139705657959, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_enpal.not_null_activity_unique_activity_id.3fd7636a20", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unique_activity_id\nfrom \"postgres\".\"public_cl_enpal\".\"activity\"\nwhere unique_activity_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-15T19:10:04.159024Z", "completed_at": "2025-12-15T19:10:04.167021Z"}, {"name": "execute", "started_at": "2025-12-15T19:10:04.167276Z", "completed_at": "2025-12-15T19:10:04.192831Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03544449806213379, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_enpal.unique_activity_unique_activity_id.45ba8f6a91", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    unique_activity_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public_cl_enpal\".\"activity\"\nwhere unique_activity_id is not null\ngroup by unique_activity_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-15T19:10:04.196511Z", "completed_at": "2025-12-15T19:10:04.199927Z"}, {"name": "execute", "started_at": "2025-12-15T19:10:04.200210Z", "completed_at": "2025-12-15T19:10:04.221665Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02678084373474121, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_enpal.not_null_deals_unique_activity_id.65b33d6ea4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unique_activity_id\nfrom \"postgres\".\"public_cl_enpal\".\"deals\"\nwhere unique_activity_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-15T19:10:04.224778Z", "completed_at": "2025-12-15T19:10:04.227874Z"}, {"name": "execute", "started_at": "2025-12-15T19:10:04.228118Z", "completed_at": "2025-12-15T19:10:04.258154Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03479647636413574, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_enpal.unique_deals_unique_activity_id.1d38a22bf1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    unique_activity_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public_cl_enpal\".\"deals\"\nwhere unique_activity_id is not null\ngroup by unique_activity_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-15T19:10:04.261241Z", "completed_at": "2025-12-15T19:10:04.265042Z"}, {"name": "execute", "started_at": "2025-12-15T19:10:04.265318Z", "completed_at": "2025-12-15T19:10:04.287192Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.027603864669799805, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_enpal.not_null_lost_reasons_lost_reason_id.92d9c240f0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect lost_reason_id\nfrom \"postgres\".\"public_cl_enpal\".\"lost_reasons\"\nwhere lost_reason_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-15T19:10:04.290427Z", "completed_at": "2025-12-15T19:10:04.293984Z"}, {"name": "execute", "started_at": "2025-12-15T19:10:04.294299Z", "completed_at": "2025-12-15T19:10:04.321915Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03298783302307129, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_enpal.unique_lost_reasons_lost_reason_id.4d05a652aa", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    lost_reason_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public_cl_enpal\".\"lost_reasons\"\nwhere lost_reason_id is not null\ngroup by lost_reason_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-15T19:10:04.325132Z", "completed_at": "2025-12-15T19:10:04.330168Z"}, {"name": "execute", "started_at": "2025-12-15T19:10:04.330454Z", "completed_at": "2025-12-15T19:10:04.423131Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0987553596496582, "adapter_response": {"_message": "INSERT 0 1", "code": "INSERT", "rows_affected": 1}, "message": "INSERT 0 1", "failures": null, "unique_id": "model.dbt_enpal.rep_sales_funnel_monthly", "compiled": true, "compiled_code": "\n\nSELECT\n    DATE_TRUNC('month', change_time)::date AS month,\n    -- this could also be done via a join to a fields table \n    -- but copilot helped me do it faster :)\n    CASE\n        WHEN\n            changed_field_key = 'stage_id' AND new_value = '1'\n            THEN 'Lead Generation'\n        WHEN\n            changed_field_key = 'stage_id' AND new_value = '2'\n            THEN 'Qualified Lead'\n        WHEN\n            changed_field_key = 'stage_id' AND new_value = '3'\n            THEN 'Needs Assessment'\n        WHEN\n            changed_field_key = 'stage_id' AND new_value = '4'\n            THEN 'Proposal/Quote Preparation'\n        WHEN\n            changed_field_key = 'stage_id' AND new_value = '5'\n            THEN 'Negotiation'\n        WHEN changed_field_key = 'stage_id' AND new_value = '6' THEN 'Closing'\n        WHEN\n            changed_field_key = 'stage_id' AND new_value = '7'\n            THEN 'Implementation/Onboarding'\n        WHEN\n            changed_field_key = 'stage_id' AND new_value = '8'\n            THEN 'Follow-up/Customer Success'\n        WHEN\n            changed_field_key = 'stage_id' AND new_value = '9'\n            THEN 'Renewal/Expansion'\n        WHEN changed_field_key = 'lost_reason' THEN 'Churned'\n    END AS kpi_name,\n    CASE\n        WHEN changed_field_key = 'stage_id' THEN CONCAT('0', new_value)\n        WHEN changed_field_key = 'lost_reason' THEN '10'\n    END AS funnel_step,\n    COUNT(*) AS deals_count\nFROM \"postgres\".\"public_cl_enpal\".\"deals\"\nWHERE\n    changed_field_key IN ('stage_id', 'lost_reason')\n    \n        AND DATE_TRUNC('month', change_time)::date\n        >= (SELECT MAX(month) FROM \"postgres\".\"public_rl_enpal\".\"rep_sales_funnel_monthly\")\n    \nGROUP BY 1, 2, 3\n\nUNION ALL\n\nSELECT\n    DATE_TRUNC('month', due_to)::date AS month,\n    -- this could also be done via a join to a fields table \n    -- but copilot helped me do it faster :)\n    CASE\n        WHEN type = 'meeting' THEN 'Sales Call 1'\n        WHEN type = 'sc_2' THEN 'Sales Call 2'\n    END AS kpi_name,\n    CASE\n        WHEN type = 'meeting' THEN '02.1'\n        WHEN type = 'sc_2' THEN '03.1'\n    END AS funnel_step,\n    COUNT(*) AS deals_count\nFROM \"postgres\".\"public_cl_enpal\".\"activity\"\nWHERE\n    type IN ('meeting', 'sc_2')\n    \n        AND DATE_TRUNC('month', due_to)::date\n        >= (SELECT MAX(month) FROM \"postgres\".\"public_rl_enpal\".\"rep_sales_funnel_monthly\")\n    \nGROUP BY 1, 2, 3", "relation_name": "\"postgres\".\"public_rl_enpal\".\"rep_sales_funnel_monthly\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-15T19:10:04.425851Z", "completed_at": "2025-12-15T19:10:04.428492Z"}, {"name": "execute", "started_at": "2025-12-15T19:10:04.428745Z", "completed_at": "2025-12-15T19:10:04.481486Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.056432485580444336, "adapter_response": {"_message": "SELECT 6558", "code": "SELECT", "rows_affected": 6558}, "message": "SELECT 6558", "failures": null, "unique_id": "model.dbt_enpal.deal_stages", "compiled": true, "compiled_code": "WITH deals AS (\n    SELECT\n        deal_id,\n        -- keeps the latest occurence for the deals that has been reactivated.\n        MAX(CASE WHEN changed_field_key = 'add_time' THEN TO_TIMESTAMP('%Y-%m-%dT%H:%M:%S%z', new_value) END) AS deal_generated_at,\n        MAX(CASE WHEN changed_field_key = 'stage_id' AND new_value = '1' THEN change_time::timestamptz END) AS lead_generated_at,\n        MAX(CASE WHEN changed_field_key = 'stage_id' AND new_value = '2' THEN change_time::timestamptz END) AS qualified_lead_at,\n        MAX(CASE WHEN changed_field_key = 'stage_id' AND new_value = '3' THEN change_time::timestamptz END) AS needs_assessment_at,\n        MAX(CASE WHEN changed_field_key = 'stage_id' AND new_value = '4' THEN change_time::timestamptz END) AS proposal_quote_preparation_at,\n        MAX(CASE WHEN changed_field_key = 'stage_id' AND new_value = '5' THEN change_time::timestamptz END) AS negotiation_at,\n        MAX(CASE WHEN changed_field_key = 'stage_id' AND new_value = '6' THEN change_time::timestamptz END) AS closing_at,\n        MAX(CASE WHEN changed_field_key = 'stage_id' AND new_value = '7' THEN change_time::timestamptz END) AS implementation_at,\n        MAX(CASE WHEN changed_field_key = 'stage_id' AND new_value = '8' THEN change_time::timestamptz END) AS activated_at,\n        MAX(CASE WHEN changed_field_key = 'stage_id' AND new_value = '9' THEN change_time::timestamptz END) AS renewal_at,\n        MAX(CASE WHEN changed_field_key = 'lost_reason' THEN change_time::timestamptz END) AS churned_at,\n        MAX(CASE WHEN changed_field_key = 'lost_reason' THEN new_value::int END) AS lost_reason_id\n    FROM \"postgres\".\"public_cl_enpal\".\"deals\"\n    GROUP BY 1\n),\n\ncalls AS (\n    SELECT\n        deal_id,\n        MAX(CASE WHEN type = 'meeting' THEN due_to::timestamptz END) AS sales_call_1_scheduled_at,\n        MAX(CASE WHEN type = 'sc_2' THEN due_to::timestamptz END) AS sales_call_2_scheduled_at\n    FROM \"postgres\".\"public_cl_enpal\".\"activity\"\n    GROUP BY 1\n)\n\nSELECT\n    COALESCE(d.deal_id, c.deal_id) AS deal_id,\n    d.deal_generated_at,\n    d.lead_generated_at,\n    d.qualified_lead_at,\n    d.needs_assessment_at,\n    d.proposal_quote_preparation_at,\n    d.negotiation_at,\n    d.closing_at,\n    d.implementation_at,\n    d.activated_at,\n    d.renewal_at,\n    d.churned_at,\n    clr.lost_reason,\n    c.sales_call_1_scheduled_at,\n    c.sales_call_2_scheduled_at\nFROM deals AS d\nFULL JOIN calls AS c\n    ON d.deal_id = c.deal_id\nLEFT JOIN \"postgres\".\"public_cl_enpal\".\"lost_reasons\" AS clr\n    ON d.lost_reason_id = clr.lost_reason_id", "relation_name": "\"postgres\".\"public_cl_enpal\".\"deal_stages\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-15T19:10:04.484406Z", "completed_at": "2025-12-15T19:10:04.487738Z"}, {"name": "execute", "started_at": "2025-12-15T19:10:04.487993Z", "completed_at": "2025-12-15T19:10:04.503068Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02025294303894043, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_enpal.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect kpi_name\nfrom \"postgres\".\"public_rl_enpal\".\"rep_sales_funnel_monthly\"\nwhere kpi_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-15T19:10:04.506233Z", "completed_at": "2025-12-15T19:10:04.509510Z"}, {"name": "execute", "started_at": "2025-12-15T19:10:04.509752Z", "completed_at": "2025-12-15T19:10:04.525553Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02087545394897461, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_enpal.not_null_rep_sales_funnel_monthly_month.d7af6eff7b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"postgres\".\"public_rl_enpal\".\"rep_sales_funnel_monthly\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-15T19:10:04.528951Z", "completed_at": "2025-12-15T19:10:04.532689Z"}, {"name": "execute", "started_at": "2025-12-15T19:10:04.532972Z", "completed_at": "2025-12-15T19:10:04.570947Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04409956932067871, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_enpal.not_null_deal_stages_deal_id.331e8474aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"public_cl_enpal\".\"deal_stages\"\nwhere deal_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-15T19:10:04.574563Z", "completed_at": "2025-12-15T19:10:04.577626Z"}, {"name": "execute", "started_at": "2025-12-15T19:10:04.577860Z", "completed_at": "2025-12-15T19:10:04.606937Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03388690948486328, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_enpal.unique_deal_stages_deal_id.e5ffe5c4b9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public_cl_enpal\".\"deal_stages\"\nwhere deal_id is not null\ngroup by deal_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 1.3004565238952637, "args": {"validate_macro_args": false, "require_yaml_configuration_for_mf_time_spines": false, "export_saved_queries": false, "macro_debugging": false, "require_resource_names_without_spaces": true, "log_format": "default", "log_path": "C:\\Users\\kazim\\Documents\\dbt_enpal\\logs", "send_anonymous_usage_stats": true, "strict_mode": false, "upload_to_artifacts_ingest_api": false, "project_dir": "C:\\Users\\kazim\\Documents\\dbt_enpal", "use_colors_file": true, "show": false, "require_all_warnings_handled_by_warn_error": false, "log_file_max_bytes": 10485760, "introspect": true, "invocation_command": "dbt build", "log_level_file": "debug", "resource_types": [], "use_fast_test_edges": false, "skip_nodes_if_on_run_start_fails": false, "log_format_file": "debug", "profiles_dir": "C:\\Users\\kazim\\Documents\\dbt_enpal", "static_parser": true, "which": "build", "quiet": false, "require_batched_execution_for_custom_microbatch_strategy": false, "show_resource_report": false, "exclude": [], "version_check": true, "defer": false, "write_json": true, "exclude_resource_types": [], "require_explicit_package_overrides_for_builtin_materializations": true, "empty": false, "include_saved_query": false, "log_level": "info", "cache_selected_only": false, "state_modified_compare_more_unrendered_values": false, "vars": {}, "favor_state": false, "source_freshness_run_project_hooks": true, "populate_cache": true, "printer_width": 80, "show_all_deprecations": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "use_colors": true, "indirect_selection": "eager", "partial_parse": true, "require_nested_cumulative_type_params": false, "state_modified_compare_vars": false, "print": true, "require_generic_test_arguments_property": true, "partial_parse_file_diff": true, "select": []}}